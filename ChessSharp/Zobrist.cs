using ChessSharp.Enums;
using ChessSharp.Extensions;
using ChessSharp.Models;
using Pcg;
using System.Linq;

namespace ChessSharp
{
    public class Zobrist
    {
        private enum CastleRights
        {
            WhiteCanCastleKingSide,
            WhiteCanCastleQueenSide,
            BlackCanCastleKingSide,
            BlackCanCastleQueenSide
        }

        private enum PieceIndex
        {
            WhitePawn,
            WhiteRook,
            WhiteKnight,
            WhiteBishop,
            WhiteQueen,
            WhiteKing,
            BlackPawn,
            BlackRook,
            BlackKnight,
            BlackBishop,
            BlackQueen,
            BlackKing
        }

        private ulong[,] _squares = new ulong[64, 12];

        private ulong[] _colours = new ulong[2];

        private ulong[] _castleRights = new ulong[4];

        public void Init()
        {
            //var gen = new PcgRandom();

            var x = 0;

            for (var i = 0; i < 64; ++i)
                for (var j = 0; j < 12; ++j)
                    _squares[i, j] = _internalRandomNumbers[x++];

            _colours[0] = 9031923140692246275;
            _colours[1] = 2884421478730253157;

            _castleRights[(int)CastleRights.WhiteCanCastleKingSide] = 24694895801582720;
            _castleRights[(int)CastleRights.WhiteCanCastleQueenSide] = 1451876467495148394;
            _castleRights[(int)CastleRights.BlackCanCastleKingSide] = 8474605413122637464;
            _castleRights[(int)CastleRights.BlackCanCastleQueenSide] = 4046274221665667751;
        }

        public ulong Hash(IBoard board, Colour colour)
        {
            var squares = (board.White | board.Black).ToList();

            ulong hash = 0ul;

            foreach (var square in squares)
            {
                var piece = BoardHelpers.GetPiece(board, square);

                hash ^= _squares[square.ToSquareIndex(), (int)Index(piece)];
            }

            if (colour == Colour.White)
                hash ^= _colours[0];
            else
                hash ^= _colours[1];

            return hash;
        }

        public ulong UpdateHash(ulong hash, uint move)
        {
            // We can just immediately flip the colour
            hash ^= _colours[0];
            hash ^= _colours[1];

            var colour = move.GetColour();
            var moveType = move.GetMoveType();

            if (moveType == MoveType.CastleKing && colour == Colour.White)
            {                
                var kingStartSquareIndex = SquareFlagConstants.WhiteKingStartSquare.ToSquareIndex();
                var rookStartSquareIndex = SquareFlagConstants.WhiteKingSideRookStartSquare.ToSquareIndex();
                var kingEndSquareIndex = SquareFlagConstants.WhiteKingSideCastleStep2.ToSquareIndex();
                var rookEndSquareIndex = SquareFlagConstants.WhiteKingSideCastleStep1.ToSquareIndex();

                // Add/Remove pieces from start positions
                hash ^= _squares[kingStartSquareIndex, (int)PieceIndex.WhiteKing];
                hash ^= _squares[rookStartSquareIndex, (int)PieceIndex.WhiteRook];

                // Add/Remove pieces from end positions
                hash ^= _squares[kingEndSquareIndex, (int)PieceIndex.WhiteKing];
                hash ^= _squares[rookEndSquareIndex, (int)PieceIndex.WhiteRook];

                return hash;
            }

            if (moveType == MoveType.CastleQueen && colour == Colour.White)
            {
                var kingStartSquareIndex = SquareFlagConstants.WhiteKingStartSquare.ToSquareIndex();
                var rookStartSquareIndex = SquareFlagConstants.WhiteQueenSideRookStartSquare.ToSquareIndex();
                var kingEndSquareIndex = SquareFlagConstants.WhiteQueenSideCastleStep2.ToSquareIndex();
                var rookEndSquareIndex = SquareFlagConstants.WhiteQueenSideCastleStep1.ToSquareIndex();

                // Add/Remove pieces from start positions
                hash ^= _squares[kingStartSquareIndex, (int)PieceIndex.WhiteKing];
                hash ^= _squares[rookStartSquareIndex, (int)PieceIndex.WhiteRook];

                // Add/Remove pieces from end positions
                hash ^= _squares[kingEndSquareIndex, (int)PieceIndex.WhiteKing];
                hash ^= _squares[rookEndSquareIndex, (int)PieceIndex.WhiteRook];

                return hash;
            }

            if (moveType == MoveType.CastleKing && colour == Colour.Black)
            {
                var kingStartSquareIndex = SquareFlagConstants.BlackKingStartSquare.ToSquareIndex();
                var rookStartSquareIndex = SquareFlagConstants.BlackKingSideRookStartSquare.ToSquareIndex();
                var kingEndSquareIndex = SquareFlagConstants.BlackKingSideCastleStep2.ToSquareIndex();
                var rookEndSquareIndex = SquareFlagConstants.BlackKingSideCastleStep1.ToSquareIndex();

                // Add/Remove pieces from start positions
                hash ^= _squares[kingStartSquareIndex, (int)PieceIndex.BlackKing];
                hash ^= _squares[rookStartSquareIndex, (int)PieceIndex.BlackRook];

                // Add/Remove pieces from end positions
                hash ^= _squares[kingEndSquareIndex, (int)PieceIndex.BlackKing];
                hash ^= _squares[rookEndSquareIndex, (int)PieceIndex.BlackRook];

                return hash;
            }

            if (moveType == MoveType.CastleQueen && colour == Colour.Black)
            {
                var kingStartSquareIndex = SquareFlagConstants.BlackKingStartSquare.ToSquareIndex();
                var rookStartSquareIndex = SquareFlagConstants.BlackQueenSideRookStartSquare.ToSquareIndex();
                var kingEndSquareIndex = SquareFlagConstants.BlackQueenSideCastleStep2.ToSquareIndex();
                var rookEndSquareIndex = SquareFlagConstants.BlackQueenSideCastleStep1.ToSquareIndex();

                // Add/Remove pieces from start positions
                hash ^= _squares[kingStartSquareIndex, (int)PieceIndex.BlackKing];
                hash ^= _squares[rookStartSquareIndex, (int)PieceIndex.BlackRook];

                // Add/Remove pieces from end positions
                hash ^= _squares[kingEndSquareIndex, (int)PieceIndex.BlackKing];
                hash ^= _squares[rookEndSquareIndex, (int)PieceIndex.BlackRook];

                return hash;
            }

            var fromSquareIndex = move.GetFrom().ToSquareIndex();
            var toSquareIndex = move.GetTo().ToSquareIndex();
            var pieceType = move.GetPieceType();
            var fromPieceIndex = (int)ToPieceIndex(colour, pieceType);
            var capturePieceIndex = (int)ToPieceIndex(colour.Opposite(), move.GetCapturePieceType());

            // Ahh En Passant. Need to adjust the capture square if this happens to be an En Passant capture.
            var captureSquareIndex = toSquareIndex;

            if (moveType == MoveType.EnPassant)
            {
                if (colour == Colour.White)
                    captureSquareIndex -= 8;
                else
                    captureSquareIndex += 8;
            }

            // And in the case of promotions the piece magically changes type so better do that.
            var toPieceIndex = fromPieceIndex;

            switch (moveType)
            {
                case MoveType.PromotionQueen: toPieceIndex = (int)ToPieceIndex(colour, PieceType.Queen); break;
                case MoveType.PromotionRook: toPieceIndex = (int)ToPieceIndex(colour, PieceType.Rook); break;
                case MoveType.PromotionBishop: toPieceIndex = (int)ToPieceIndex(colour, PieceType.Bishop); break;
                case MoveType.PromotionKnight: toPieceIndex = (int)ToPieceIndex(colour, PieceType.Knight); break;
                default: break;
            }

            // Add/Remove the moving piece to/from source square
            hash ^= _squares[fromSquareIndex, fromPieceIndex];

            // Add/Remove a captured piece to/from target square
            if (move.GetCapturePieceType() != PieceType.None)
                hash ^= _squares[captureSquareIndex, capturePieceIndex];

            // Add/Remove the moving piece to/from target square
            hash ^= _squares[toSquareIndex, toPieceIndex];

            return hash;
        }

        private ulong Random64(PcgRandom gen)
        {
            var int1 = (ulong)gen.Next();
            var int2 = (ulong)gen.Next();

            ulong result = int1 << 32;
            result += int2;

            return result;
        }

        private PieceIndex ToPieceIndex(Colour colour, PieceType type)
        {
            switch (type)
            {
                case PieceType.Pawn when colour == Colour.White:
                    return PieceIndex.WhitePawn;
                case PieceType.Rook when colour == Colour.White:
                    return PieceIndex.WhiteRook;
                case PieceType.Knight when colour == Colour.White:
                    return PieceIndex.WhiteKnight;
                case PieceType.Bishop when colour == Colour.White:
                    return PieceIndex.WhiteBishop;
                case PieceType.Queen when colour == Colour.White:
                    return PieceIndex.WhiteQueen;
                case PieceType.King when colour == Colour.White:
                    return PieceIndex.WhiteKing;
                case PieceType.Pawn when colour == Colour.Black:
                    return PieceIndex.BlackPawn;
                case PieceType.Rook when colour == Colour.Black:
                    return PieceIndex.BlackRook;
                case PieceType.Knight when colour == Colour.Black:
                    return PieceIndex.BlackKnight;
                case PieceType.Bishop when colour == Colour.Black:
                    return PieceIndex.BlackBishop;
                case PieceType.Queen when colour == Colour.Black:
                    return PieceIndex.BlackQueen;
                case PieceType.King when colour == Colour.Black:
                    return PieceIndex.BlackKing;
                default:
                    return 0;
            }
        }

        private PieceIndex Index(Piece piece)
        {
            switch (piece.Type)
            {
                case PieceType.Pawn when piece.Colour == Colour.White:
                    return PieceIndex.WhitePawn;
                case PieceType.Rook when piece.Colour == Colour.White:
                    return PieceIndex.WhiteRook;
                case PieceType.Knight when piece.Colour == Colour.White:
                    return PieceIndex.WhiteKnight;
                case PieceType.Bishop when piece.Colour == Colour.White:
                    return PieceIndex.WhiteBishop;
                case PieceType.Queen when piece.Colour == Colour.White:
                    return PieceIndex.WhiteQueen;
                case PieceType.King when piece.Colour == Colour.White:
                    return PieceIndex.WhiteKing;
                case PieceType.Pawn when piece.Colour == Colour.Black:
                    return PieceIndex.BlackPawn;
                case PieceType.Rook when piece.Colour == Colour.Black:
                    return PieceIndex.BlackRook;
                case PieceType.Knight when piece.Colour == Colour.Black:
                    return PieceIndex.BlackKnight;
                case PieceType.Bishop when piece.Colour == Colour.Black:
                    return PieceIndex.BlackBishop;
                case PieceType.Queen when piece.Colour == Colour.Black:
                    return PieceIndex.BlackQueen;
                case PieceType.King when piece.Colour == Colour.Black:
                    return PieceIndex.BlackKing;
                default:
                    return 0;
            }
        }

        // Pre-generated number purely so that keys are ALWAYS the same
        private ulong[] _internalRandomNumbers = new ulong[768]
            {
                4072067707504170,
                28195254883754324,
                28622651476083318,
                58815381252961135,
                95889135177982357,
                99988505755743879,
                107205842585407148,
                108099659939061368,
                144184205825107321,
                177244869965423283,
                188903044697397208,
                204426489865133565,
                209555497021316832,
                232561247827078885,
                240743569620031669,
                244992201685295043,
                279590367467055254,
                283908960704336077,
                294736115344701220,
                298945183107224724,
                300946839605649480,
                319818765654243187,
                335883298028768213,
                342087553561225392,
                342930718858330478,
                349572088618046900,
                350077271240722701,
                381713395036644291,
                389202044126131731,
                440476557291127070,
                443864796466551046,
                447340134330167566,
                450745398629709347,
                455627380696094429,
                456413830864728547,
                464591251689489496,
                468590291213694999,
                471883450354219942,
                509009653502948584,
                511403569063800350,
                525370596936405432,
                526269528396565185,
                526627372998401360,
                531355948356340732,
                549611207385121588,
                553504768369028621,
                558968093979286352,
                588520829101989438,
                589342073238144248,
                589392217270995274,
                592388128552994375,
                597117858358280370,
                623243105256072258,
                624711897985108809,
                626256505186479374,
                645990643039695503,
                647303455547643855,
                675351404080163880,
                696214268104702576,
                702607383384251523,
                727986482572094484,
                735068148291770747,
                741708803654382280,
                754628869332719393,
                765748641954471355,
                766779992817206752,
                778356803214819535,
                847519739346573024,
                849474237338901620,
                864036155365727071,
                871277267947108792,
                913105238514492584,
                940839008890492643,
                944318479659962694,
                950483358976060452,
                981560192559783920,
                983842675649135162,
                989170731508706858,
                991202126240757389,
                993301408041560411,
                1002761834752999652,
                1010566240893643060,
                1024368539075273549,
                1064193949731304125,
                1083056452963723214,
                1101159195692370997,
                1146621025451289437,
                1160557845012496724,
                1183484759847611686,
                1184959840675434483,
                1190434123094650154,
                1194954745127361178,
                1199935428525815514,
                1205082647514381546,
                1210974556026221062,
                1233625915936778909,
                1241897263830528403,
                1243466550560755572,
                1259707488502319362,
                1261868658835902043,
                1272384976332079030,
                1277825536131257920,
                1283765966688943395,
                1291035877185432236,
                1301672682386462288,
                1305128505933296427,
                1309760409637607306,
                1338745456710430927,
                1344433512261827741,
                1351161686620790931,
                1365606331653448830,
                1365941245753815309,
                1388013880231101635,
                1403221543350053031,
                1406574749075671131,
                1407113279053974315,
                1434119096310752768,
                1456592482409836586,
                1458054545186498926,
                1467623400932872912,
                1468916333615877326,
                1481692970578962349,
                1484227174369666161,
                1512438929574566723,
                1516653050801579415,
                1517426816748314843,
                1540881246765039631,
                1561376250250946843,
                1570329277368606943,
                1579873758567208154,
                1589280893221988503,
                1592577589902489223,
                1604475266991902139,
                1619407588419350297,
                1631134023103785718,
                1636049598947386757,
                1637081662094849486,
                1651336139781335560,
                1654609282737726628,
                1655067417246829742,
                1675084096385141806,
                1695328583993190448,
                1707159482122791305,
                1708002790213943449,
                1735529396494937492,
                1743881294646007723,
                1748493677924259087,
                1757441073123699148,
                1762174736986182695,
                1796543959493617016,
                1812736238996739528,
                1822416945171427861,
                1823807211755707177,
                1824973918140904969,
                1840569946646875081,
                1845117050337728138,
                1845339490229468491,
                1849392779180793157,
                1853831787791341104,
                1870852738700928700,
                1873843585847325295,
                1879017264194581416,
                1888278654318316464,
                1905220427680226521,
                1924169737034951628,
                1926638896251590638,
                1929865348221152717,
                1930742269826211175,
                1932489066564139507,
                1939845280328462124,
                1940189989842740714,
                1940961723227137739,
                1942780125288214452,
                1971124745415227065,
                1995984003952235644,
                2007104614315547182,
                2025890093047523332,
                2037938674523334529,
                2047583436256261524,
                2050834438340882897,
                2066269137519402497,
                2067536431890417432,
                2072125081684242270,
                2080269046749152310,
                2100877639443804107,
                2105476292747384621,
                2125645269884502078,
                2127759909064570345,
                2165295775892710655,
                2172335772033970091,
                2173353739981878395,
                2174575092444573319,
                2176741498187383401,
                2191882331353483106,
                2193166209890485266,
                2193880226493281191,
                2202748135525619926,
                2202877903675851443,
                2203601812030136279,
                2224876190457194782,
                2402582558186672641,
                2409455510428433616,
                2438375083679474863,
                2466193698218094507,
                2493415506489746454,
                2508284257133275013,
                2515906343427498631,
                2526661598717112167,
                2542299243316750848,
                2549383685588155281,
                2574813078010968423,
                2598689122536156277,
                2600105521279115916,
                2611824520171235934,
                2619147530311613523,
                2636565061422311243,
                2664503879169751933,
                2667057975140190963,
                2667493357995634674,
                2672348675253466151,
                2687755586390751681,
                2697707941531095812,
                2701068537591986181,
                2718753469378069571,
                2733540852757422396,
                2739246558179449801,
                2749984574316363830,
                2759421079277991225,
                2766797274283859631,
                2767345858437578282,
                2779795164298429037,
                2803904176819471526,
                2813561947496242660,
                2904357882757032118,
                2907443966887904234,
                2916439311573634497,
                2927832477181986557,
                2946124192938694339,
                2954520395550570889,
                2955973768111565259,
                2966249938217983817,
                2967553159897485058,
                2973479620853533681,
                2987395999822836904,
                3013758994132925276,
                3020513474573738792,
                3020585479676084431,
                3023228584983298459,
                3039916881770095435,
                3044145529552650293,
                3046211198380129314,
                3056512290795231326,
                3081168407239095215,
                3089032391962624902,
                3089043891006553178,
                3095933774140086752,
                3103828606921520949,
                3115356427244739241,
                3117980984383601050,
                3127816947299484371,
                3133467514744487758,
                3145959989521597833,
                3153191953429943846,
                3168082760576159511,
                3170096463522739785,
                3171119045406438902,
                3173238250736509663,
                3174745139450277840,
                3175897741459468177,
                3185402031974587449,
                3189671821092137714,
                3191448631668425361,
                3195122182797609734,
                3203635820919292048,
                3221379624395377846,
                3245646387138590399,
                3252279881499431198,
                3259355132838108979,
                3290684590600525678,
                3296697664092064059,
                3300397552629069790,
                3303814216311877020,
                3329617417251389885,
                3344675734563646483,
                3348472593085270096,
                3376336417097619310,
                3378880261088374231,
                3388019686879120603,
                3397346447957336022,
                3416790788378455726,
                3433789722000976701,
                3438188765530642014,
                3441045950073321252,
                3455167776639990897,
                3490835774323016947,
                3504837458818543555,
                3508416721332764372,
                3511204948200313024,
                3520322576770105023,
                3526983559147772408,
                3527460974761292487,
                3548727364722446788,
                3553700282794605289,
                3569955459151729815,
                3595545191807641096,
                3597188334964529463,
                3600905787012514372,
                3634702731538102034,
                3634953621865253128,
                3655629001814494999,
                3660910643172349390,
                3664935687979552336,
                3686524741773910974,
                3704557976614592590,
                3706575856836133608,
                3716881719905997496,
                3719741094245038785,
                3732559446519790369,
                3747885838453437153,
                3759047028498031450,
                3777187158307450848,
                3805747351784372600,
                3808344642021896640,
                3823565156600185608,
                3830455600970074533,
                3846352177950913939,
                3854368060857086511,
                3880863606751909203,
                3892044191814907519,
                3900223940489258549,
                3905858502558816337,
                3907642438460087415,
                3910120863570517221,
                3936107884901138206,
                3962969963457404686,
                3969887201857845677,
                3974730373689648938,
                3983405134419344136,
                3991075722473528275,
                4006550746715787445,
                4010376758777044709,
                4012447677325788540,
                4061412748504365773,
                4070783782838229574,
                4073054535620489751,
                4074490854247902465,
                4081382507495627833,
                4089305179378645393,
                4129682881832442124,
                4131590730390875482,
                4155146844467555390,
                4159139819850250741,
                4186314254228643561,
                4194922872298713451,
                4200516846617724395,
                4226869066838659692,
                4227514527363903754,
                4235061772305623557,
                4291564631417118139,
                4296955429368419114,
                4315872294803939028,
                4322295577302573558,
                4332081625618368125,
                4342188675300169241,
                4345646316705906418,
                4354488925502017690,
                4386455954780264606,
                4416070101247126007,
                4422227971615038928,
                4431284718968443132,
                4434651190347493849,
                4463429473099197377,
                4465976969925208677,
                4472237617726083046,
                4477636426019063022,
                4481037134454801132,
                4491010323437891786,
                4501525606877915955,
                4527192996767401212,
                4534142587718282409,
                4552673485967360954,
                4557051751146807368,
                4559464185396368949,
                4565881357923575891,
                4596276996328398719,
                4604673763613567248,
                4605224799611378042,
                4644890347066495028,
                4648717592316660415,
                4681133425260265107,
                4683635079303675597,
                4699837604361747050,
                4703127882939784365,
                4709122200730931196,
                4720327720132055886,
                4729553833847767943,
                4733539971960344308,
                4748397490499489484,
                4758612838796971270,
                4767883492189611951,
                4775242815445825158,
                4776139523412106140,
                4779939142579073160,
                4801972320295966785,
                4804790716581382857,
                4826765534104421335,
                4837581852683424438,
                4853408419268900364,
                4853701018806895103,
                4907221146615753295,
                4914487820009454736,
                4929919272491249401,
                4930780877280587508,
                4938223454312007624,
                4951786663758673170,
                4955503119878413053,
                4959458846599832385,
                4965948473280525347,
                4968019857812752308,
                4972117007512088550,
                4980090649813624510,
                4985499116786809847,
                4992251260733163071,
                5006340827447617104,
                5009541492318837543,
                5012436662446335111,
                5059911774273276483,
                5061166127124394762,
                5063393326224071695,
                5102630944943961178,
                5112075117623882350,
                5120971193168420431,
                5123524302414839748,
                5130279583251284993,
                5133857234649316524,
                5142391575107005516,
                5142654696269449904,
                5144887561347993602,
                5164213427988482733,
                5164288159811538193,
                5165553546371427180,
                5166240294853276389,
                5167802911038748534,
                5171055043233468504,
                5182564822469667542,
                5202170695403310345,
                5214639491607561639,
                5215210091187808444,
                5236781826913158199,
                5237694228525971150,
                5240495993078487226,
                5244630719413981615,
                5245505814717425189,
                5274346856508509663,
                5288616077292759482,
                5291965915291814680,
                5323417921360674387,
                5332373083938199962,
                5334595123402420377,
                5338954434125625412,
                5342082716623626089,
                5344274181117302288,
                5394489631297121296,
                5395571157259758086,
                5425321728414632942,
                5430873808013197882,
                5462992109706636244,
                5469775508161642939,
                5473648679447500514,
                5487220995704225092,
                5499772160425705449,
                5533704928591676321,
                5537555997160698174,
                5537917242244764738,
                5547133152068110849,
                5554059443394828518,
                5599339378219851905,
                5606272553165904914,
                5611382930463739333,
                5617293873177972080,
                5620491670975013327,
                5635076538218760272,
                5640741220826807957,
                5649613610493252335,
                5664268249090384762,
                5666324833460327495,
                5681151348563530505,
                5688225607129465546,
                5691144788026222870,
                5693298431975502842,
                5719842158972826686,
                5741575831325984444,
                5758392856391868184,
                5772538974761227125,
                5785618547340163310,
                5794567171185924041,
                5796513843357865681,
                5815843662787798118,
                5816027241978210483,
                5829513894194130962,
                5829663165281146059,
                5831948891474259814,
                5841166059202851295,
                5859086342211744561,
                5860242667498498029,
                5866140649764431719,
                5884234257057855021,
                5907222141448271628,
                5915949144842184907,
                5931965590120824072,
                5934329967956660816,
                5946710335448439784,
                5973863548408549745,
                5979249808385418240,
                5984369601267810211,
                5987830722255334860,
                5992921414559537422,
                5997903421385996807,
                6007008637419061962,
                6009229118255117583,
                6026832809030571487,
                6052693864900255794,
                6056278813605798918,
                6070853561853271381,
                6078722297570806613,
                6105931741040683493,
                6107535966706688607,
                6114249978981063846,
                6142049482853476597,
                6143897124775751897,
                6155488365033251562,
                6160374350740856400,
                6172107445902808567,
                6176065589634463131,
                6206918374110526946,
                6211536504808684036,
                6252361395774261864,
                6273010135462518536,
                6274152823979933768,
                6287660821194243393,
                6304668663995874081,
                6311612906413723880,
                6316688293183086499,
                6325974231854151034,
                6344012193395517134,
                6347419738671814295,
                6361787275475182342,
                6363924846520687144,
                6364012344455699427,
                6365666344541274989,
                6367660467195204676,
                6378163587332319427,
                6378588594694370769,
                6386700492110407701,
                6401152399860414503,
                6408022328988731709,
                6433869510851365591,
                6443373143183416004,
                6450005895003608688,
                6455826714719935010,
                6457067569849109603,
                6462372914403943669,
                6467099286631313066,
                6481684075050935859,
                6482926187782391168,
                6485665023740833945,
                6489188277587539033,
                6499374698009791072,
                6529131424350863605,
                6544857641253905136,
                6555469333383168860,
                6558282372839709461,
                6593700687014532571,
                6648763221998312202,
                6658387306382324652,
                6673280585748074090,
                6678975378574558963,
                6698536273555262746,
                6722773095728549124,
                6741181464779436076,
                6751364479749276104,
                6759521733637897733,
                6768708597141176561,
                6769031891999439974,
                6787607774983648013,
                6804935601450738595,
                6809416352567930911,
                6820243831597653089,
                6856285381271128412,
                6907401573038240090,
                6944815205626647152,
                6954554541699881034,
                6967465068132108799,
                6975147813946487063,
                6980222756602114735,
                6984223141481693505,
                6995765312076125610,
                7005040993217072519,
                7009287873802890085,
                7021181214018275091,
                7051802737345532566,
                7062514964588032618,
                7070478535120001365,
                7074102193896532865,
                7075087142815975803,
                7087011456790748415,
                7093082050634644682,
                7113180847996874226,
                7129973254876187581,
                7205613943689922276,
                7216132743438065986,
                7219232679645246487,
                7226181579068076799,
                7226673199336120426,
                7240562492003151588,
                7252923699771247848,
                7256426524114741849,
                7279566798031329634,
                7288466450916141029,
                7349988384614190460,
                7361457908498283214,
                7424641027558998528,
                7438473883571435991,
                7450127819154801657,
                7453665724256031162,
                7460507444614262368,
                7476961782230782859,
                7487599852547059991,
                7494155174961703570,
                7600332290628775058,
                7606139412824125107,
                7610840156883000857,
                7619676179074015250,
                7639866442312949689,
                7640405979758384222,
                7648939054240406047,
                7668190617158554481,
                7682228319052297750,
                7699097378543117908,
                7700181927395737435,
                7708621813081526183,
                7727736404619173490,
                7741834180153467486,
                7763958511056890007,
                7782222623073447107,
                7786389960740764588,
                7792336115720787362,
                7815488695252060807,
                7867137067878988173,
                7939011953828242333,
                7939850915097038376,
                7940242712172466915,
                7950617183203652718,
                7956601665513809729,
                7981055659987794634,
                8008777801725295173,
                8008922000152444113,
                8012976483338406744,
                8014854742447343618,
                8015222485917910865,
                8020372992764832352,
                8021844272957879523,
                8029461763004453667,
                8039729990066450190,
                8048064236901158946,
                8051134666104959737,
                8061976065368920022,
                8089347611209627539,
                8099848043308560766,
                8099911788710965801,
                8104894234162511732,
                8117637999420356381,
                8123815320681629112,
                8125174816227975702,
                8167734050371582392,
                8172285874705078349,
                8181909272585425407,
                8184054780431880144,
                8195947674729942283,
                8198706953397235576,
                8209803298928934590,
                8232796439667882929,
                8235516701372740619,
                8241900753830059413,
                8242699818861959087,
                8245128029044052768,
                8247546873887903784,
                8253265520515737744,
                8256434665017706163,
                8265158911846968194,
                8298341180120063564,
                8301003857805356442,
                8308131004107507758,
                8310495512012370655,
                8312245819205979751,
                8324390959899216644,
                8334893065749983721,
                8339061468877479987,
                8347752197711446420,
                8355076400498794227,
                8393837359909184490,
                8394854077131648402,
                8430777815501687829,
                8442528124118938090,
                8442781595736497510,
                8446315365592133068,
                8457560076205608140,
                8462015142547967725,
                8485964450528719208,
                8512444608295744319,
                8514732636102782729,
                8524534430439761220,
                8553752272511017603,
                8557531655421642161,
                8571803926427120370,
                8585090974442749130,
                8586111887434033293,
                8591074331132266476,
                8602674320159756580,
                8619237304148803470,
                8629790605105344718,
                8641492723790823763,
                8645573227572122402,
                8652457802119279033,
                8654771289722551764,
                8696113576837653386,
                8718380560077351277,
                8755655837873705128,
                8768387044371717097,
                8774141337590938972,
                8775156693299757758,
                8775749888312680047,
                8779530086778730929,
                8800871006105782589,
                8823460210659547313,
                8834703013482247847,
                8844564640532368590,
                8846373148385931292,
                8848854973708974874,
                8865963646134008982,
                8869515730653956764,
                8883166329813331968,
                8901500896127529814,
                8908537564655686256,
                8925581481880636721,
                8926801839635212283,
                8933155234256711249,
                8975936097688908368,
                9010080595400465563,
                9011721822824231506,
                9025243233352720975,
                9027339938981848020,
                9045595490525207261,
                9047138477943332169,
                9066272162004702863,
                9069192260352975193,
                9076220969695044702,
                9107630928587804407,
                9125308031215715612,
                9127027095538232772,
                9133258748822872212,
                9152597276684919017,
                9177664687727019557,
                9181474911635711185,
                9186668794020627606,
                9196516212651647749,
                9200293584186430943,
                9221359626424558306
            };
    }
}
